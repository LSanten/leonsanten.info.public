<!DOCTYPE html>

<!--
 // WEBSITE: https://themefisher.com
 // TWITTER: https://twitter.com/themefisher
 // FACEBOOK: https://www.facebook.com/themefisher
 // GITHUB: https://github.com/themefisher/
-->

<html lang="en-us"><head>
  <meta charset="utf-8">
  <meta name="license" content="https://creativecommons.org/licenses/by-nc-sa/4.0/">
  <title>Life before the Agricultural Revolution</title>

  <!-- mobile responsive meta -->
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Here is a marble for you! I hope it helps you engage in dialogue, plant a seed, or elicit collaboration.">
  <meta name="author" content="Leon Santen">
  <meta property="og:image" content="https://leonsanten.info/assets/marble-assets/images/marble-imagery/woven-marble-3.png">
  <meta property="og:title" content="Life before the Agricultural Revolution">
  <meta property="og:type" content="article">
  <meta property="og:url" content="https://leonsanten.info/marbles">
  <meta property="og:description" content="The Süddeutsche Zeitung article from April 1, 2021, is not an April Fool’s joke but a legitimate article discussing James Suzman’s book “Sie nannten es Arbeit” (published in English as “Work: A History of How We Spend Our Time”) [1].">
  <meta property="og:site_name" content="leon's marble sharings 🔮">












  <!-- plugins -->

  <link rel="stylesheet" href="../../assets/marble-assets/plugins/bootstrap/bootstrap.min.css">
    <link rel="stylesheet" href="../../assets/marble-assets/plugins/themify-icons/themify-icons.css">
    <link rel="stylesheet" href="../../assets/marble-assets/plugins/slick/slick.css">


  <!-- Main Stylesheet -->
  <link rel="stylesheet" href="../../assets/marble-assets/css/style.css" media="screen">

  <!--Favicon-->
  <link rel="apple-touch-icon" sizes="180x180" href="../../assets/marble-assets/favicon_io/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="../../assets/marble-assets/favicon_io/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="../../assets/marble-assets/favicon_io/favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">
      <!-- good favicon converter: https://favicon.io/favicon-converter/ -->


  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"> <!-- for ICONS -->



  <!-- FOR EXPAND BUTTON -->
  <style>
  #more {display: none;}
  </style>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>


  <!-- FOR LATEX RENDERING -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css">
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/contrib/auto-render.min.js"></script>
  <script>
  document.addEventListener("DOMContentLoaded", function() {
      renderMathInElement(document.body, {
          delimiters: [
              { left: "$$", right: "$$", display: true },
              { left: "$", right: "$", display: false }
          ],
          throwOnError: false
      });
  });
  </script>

  <!-- FOR LINCENSE -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org/",
    "@type": "CreativeWork",
    "license": "https://creativecommons.org/licenses/by-nc-sa/4.0/",
    "author": {
      "@type": "Person",
      "name": "Leon Santen"
    }
  }
  </script>

  <!-- Advanced Image Viewer Styles -->
  <style>
    #image-zoom-overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: rgba(0, 0, 0, 0.9);
      z-index: 9999;
      justify-content: center;
      align-items: center;
      cursor: zoom-out;
      touch-action: none; /* Prevents default touch behaviors for better control */
    }

    #image-zoom-container {
      position: relative;
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
    }

    #image-zoom-img {
      max-width: 100%;
      max-height: 100%;
      object-fit: contain;
      transform-origin: center center;
      transition: transform 0.1s ease-out;
      cursor: grab;
      border-radius: 0;
    }

    #image-zoom-img.grabbing {
      cursor: grabbing;
    }

    #image-zoom-close {
      position: absolute;
      top: 20px;
      right: 20px;
      background: rgba(0, 0, 0, 0.5);
      color: white;
      border: none;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      font-size: 24px;
      cursor: pointer;
      z-index: 10000;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background 0.2s;
    }

    #image-zoom-close:hover {
      background: rgba(0, 0, 0, 0.8);
    }

    #zoom-info {
      position: absolute;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(0, 0, 0, 0.5);
      color: white;
      padding: 5px 10px;
      border-radius: 20px;
      font-size: 14px;
      opacity: 0;
      transition: opacity 0.3s;
    }

    .content img {
      cursor: zoom-in;
    }

    /* Hide zoom info after short time */
    .fade-out {
      opacity: 0 !important;
    }

    /* Mobile optimizations */
    @media (max-width: 768px) {
      #image-zoom-img {
        max-width: 100vw;
        max-height: 100vh;
      }

      #image-zoom-close {
        top: 10px;
        right: 10px;
      }
    }
  </style>

</head>
<body>
  <!-- navigation -->

<!--
<header class="navigation fixed-top">
  <div class="container">
    <nav class="navbar navbar-expand-lg navbar-white">

      <div class="collapse navbar-collapse text-center order-lg-2 order-3" id="navigation">
        <ul class="navbar-nav mx-auto">


          <li class="nav-item dropdown">
            <a class="nav-link" href="#" role="button" data-toggle="dropdown" aria-haspopup="true"
              aria-expanded="false">
              homepage <i class="ti-angle-down ml-1"></i>
            </a>
            <div class="dropdown-menu">
              <a class="dropdown-item" href="index-full.html">Homepage Full Width</a>

              <a class="dropdown-item" href="index-full-left.html">Homepage Full With Left Sidebar</a>

              <a class="dropdown-item" href="index-full-right.html">Homepage Full With Right Sidebar</a>

              <a class="dropdown-item" href="index-list.html">Homepage List Style</a>

              <a class="dropdown-item" href="index-list-left.html">Homepage List With Left Sidebar</a>

              <a class="dropdown-item" href="index-list-right.html">Homepage List With Right Sidebar</a>

              <a class="dropdown-item" href="index-grid.html">Homepage Grid Style</a>

              <a class="dropdown-item" href="index-grid-left.html">Homepage Grid With Left Sidebar</a>

              <a class="dropdown-item" href="index-grid-right.html">Homepage Grid With Right Sidebar</a>

            </div>
          </li>
          <li class="nav-item dropdown">
            <a class="nav-link" href="#" role="button" data-toggle="dropdown" aria-haspopup="true"
              aria-expanded="false">
              About <i class="ti-angle-down ml-1"></i>
            </a>
            <div class="dropdown-menu">

              <a class="dropdown-item" href="about-me.html">About Me</a>

              <a class="dropdown-item" href="about-us.html">About Us</a>

            </div>
          </li>

          <li class="nav-item">
            <a class="nav-link" href="contact.html">Contact</a>
          </li>

          <li class="nav-item dropdown">
            <a class="nav-link" href="#" role="button" data-toggle="dropdown" aria-haspopup="true"
              aria-expanded="false">Pages <i class="ti-angle-down ml-1"></i>
            </a>
            <div class="dropdown-menu">

              <a class="dropdown-item" href="author.html">Author</a>

              <a class="dropdown-item" href="author-single.html">Author Single</a>

              <a class="dropdown-item" href="advertise.html">Advertise</a>

              <a class="dropdown-item" href="post-details.html">Post Details</a>

              <a class="dropdown-item" href="post-elements.html">Post Elements</a>

              <a class="dropdown-item" href="tags.html">Tags</a>

              <a class="dropdown-item" href="search-result.html">Search Result</a>

              <a class="dropdown-item" href="search-not-found.html">Search Not Found</a>

              <a class="dropdown-item" href="privacy-policy.html">Privacy Policy</a>

              <a class="dropdown-item" href="terms-conditions.html">Terms Conditions</a>

              <a class="dropdown-item" href="404.html">404 Page</a>

            </div>
          </li>



          <a class="navbar-brand order-1" href="index.html">
        <img class="img-fluid" width="100px" src="images/logo.png"
          alt="Reader | Hugo Personal Blog Template">
      </a>
      <a class="navbar-brand order-1" href="index.html">
        <img class="img-fluid" width="100px" src="images/logo.png"
          alt="Reader | Hugo Personal Blog Template">
      </a>
      <a class="navbar-brand order-1" href="index.html">
        <img class="img-fluid" width="100px" src="images/logo.png"
          alt="Reader | Hugo Personal Blog Template">
      </a>
        </ul>
      </div>

      <div class="order-2 order-lg-3 d-flex align-items-center">

        <button class="navbar-toggler border-0 order-1" type="button" data-toggle="collapse" data-target="#navigation">
          <i class="ti-menu"></i>
        </button>
      </div>

    </nav>
  </div>
</header>
-->

<!-- /navigation -->

<!-- start of banner -->
<div class="banner text-center">
  <div class="container">
    <div class="row">
      <div class="col-lg-7 mx-auto">
        <h4 class="text-shadow">Here, I have a <i>marble</i> for you.</h4>
        <h5 class="text-shadow">Yours, <a href="https://leonsanten.info/" target="_blank" style="color: #914c9a; text-decoration: none;">Leon</a></h5>
        <image width="250px" style="display: block; margin: 0 auto;" src="../../assets/marble-assets/images/marble-imagery/woven-marble-3.png">
        </br>
        <span class="dots"></span>

            <span class="more">
              <p style="text-decoration: none; border: 2px solid black; padding: 4px 8px; background-color:#daf0ffc2; border-radius: 15px; color: black;">In my world, a marble is a metaphorical container for a note that I want to share and shape with you. It can be a sketchy idea, an insight, a piece of knowledge, or a question that I consider valuable for my life's ongoing dialogue.<br><br>These marbles are never perfect and always a snapshot of a given moment. So, please, feel free to add your perspective at the ⬇️ <a href="#comment-zone">bottom of the page</a>. I try to follow the 🔮 <a href="../MEDIA-MOVEMENT-BUILDING-A/" target="_blank">principles for media movement building</a>.<br><br>
              Read more about my intentions in 🔮 <a href="../MMSCommuniA/" target="_blank">this marble</a>.

              <!--<br><br>In the past, I didn't have a way to share ideas or insights with others. This marbles website is the manifestation of my desire to share intentionally with the world. If you want to do it too, let me know. I can help you. -->
</p>

            </span>

            <button class="read">⏷ What is a marble?</button>

      </div>
    </div>
  </div>


  <img class="banner-shape-1" width="100"  viewBox="0 0 39 39" src="../../assets/marble-assets/images/backgrounds/shape-2.png">

  <img class="banner-shape-2" width="80"  viewBox="0 0 39 40" src="../../assets/marble-assets/images/backgrounds/shape-4.png">

  <img class="banner-shape-3" width="100"  viewBox="0 0 39 40" src="../../assets/marble-assets/images/backgrounds/shape-3.png">


</div>
<!-- end of banner -->






<section class="section">
  <div class="container">
    <div class="row justify-content-center">
      <div class="col-lg-7   mb-5 mb-lg-0">
        <article>


          <!-- Page Images: [] JUST SOME CODE TO SEE IF IMAGES ARE IN FRONTMATTER -->


          
            
            
            
            

            
              
              
                <span class="marble-date">Created on April 27, 2025</span>
              
            

            
          


          <h1 id="life-before-the-agricultural-revolution">Life before the Agricultural Revolution</h1>

<h1 id="the-less-work-the-better---research-finding-on-work-patterns-of-hunter-gatherers">“The less work, the better” - Research finding on work patterns of hunter-gatherers</h1>
<h2 id="je-weniger-arbeit-desto-besser">“Je weniger Arbeit, desto besser”</h2>

<h2 id="the-articles-authenticity">The Article’s Authenticity</h2>
<p>The Süddeutsche Zeitung <a href="https://www.sueddeutsche.de/wissen/steinzeit-arbeitskultur-arbeitszeit-1.5252375?reduced=true#libraryItemId=12192187" target="_blank">article</a> from April 1, 2021, <strong>is not an April Fool’s joke</strong> but a legitimate article discussing James Suzman’s book “Sie nannten es Arbeit” (published in English as “Work: A History of How We Spend Our Time”) [1].</p>

<h2 id="hunter-gatherer-work-hours">Hunter-Gatherer Work Hours</h2>

<p>Research indicates that hunter-gatherers did work significantly less than modern humans:</p>

<ul>
  <li>Anthropological studies suggest hunter-gatherers worked approximately <strong>15-20 hours per week</strong> on direct food acquisition [2]</li>
  <li>When including all subsistence-related activities, total working time was about <strong>30-40 hours per week</strong> [3]</li>
  <li>This is less than the average modern workweek when domestic chores and commuting are included</li>
  <li>The “<strong>Original Affluent Society</strong>” hypothesis by Marshall Sahlins suggests hunter-gatherers had considerable leisure time [2]</li>
</ul>

<h2 id="hunter-gatherer-lifespan">Hunter-Gatherer Lifespan</h2>

<p>The evidence on hunter-gatherer lifespans is nuanced:</p>

<ul>
  <li>If a hunter-gatherer survived childhood, they could often live to relatively old age</li>
  <li>The “modal adult life span” (most common age of death for adults) was <strong>68-78 years</strong> [4]</li>
  <li>Overall life expectancy was much lower (21-37 years) primarily due to high infant and childhood mortality [5]</li>
  <li>Hunter-gatherers who reached adulthood had mortality patterns similar to pre-modern agricultural societies</li>
  <li>The transition to agriculture often initially worsened health and decreased lifespan due to:
    <ul>
      <li>Increased disease transmission</li>
      <li>Less varied diets</li>
      <li>Harder physical labor [6]</li>
    </ul>
  </li>
</ul>

<h2 id="historical-significance">Historical Significance</h2>

<ul>
  <li>For about 95% of human history (roughly 285,000 of 300,000 years), humans lived as hunter-gatherers</li>
  <li>The agricultural revolution created significant changes in human society, including:
    <ul>
      <li>Increased workload</li>
      <li>More diseases and epidemics</li>
      <li>New social hierarchies</li>
      <li>Surplus production allowing population growth [7]</li>
    </ul>
  </li>
</ul>

<h2 id="contemporary-relevance">Contemporary Relevance</h2>

<ul>
  <li>Modern technology was expected to reduce working hours (John Maynard Keynes predicted 15-hour workweeks by now) [8]</li>
  <li>Instead, we work more despite unprecedented productivity</li>
  <li>COVID-19 pandemic has highlighted problems in our work culture and created opportunities to reconsider our relationship with work</li>
  <li>Suzman suggests alternatives like universal basic income and reducing work hours could benefit both humans and the planet [9]</li>
</ul>

<h2 id="references">References</h2>

<p>[0] <a href="https://www.sueddeutsche.de/wissen/steinzeit-arbeitskultur-arbeitszeit-1.5252375?reduced=true#libraryItemId=12192187" target="_blank">https://www.sueddeutsche.de/wissen/steinzeit-arbeitskultur-arbeitszeit-1.5252375?reduced=true#libraryItemId=12192187</a></p>

<p>[1] Amazon.de and other German book retailers listing Suzman’s book with citations from the Süddeutsche Zeitung article</p>

<p>[2] Original Affluent Society - Wikipedia, based on Marshall Sahlins’ research</p>

<p>[3] Various research papers on hunter-gatherer work patterns, including studies by Gurven and Kaplan</p>

<p>[4] “Longevity Among Hunter-Gatherers: A Cross-Cultural Examination” by Gurven and Kaplan (2007)</p>

<p>[5] “Hunter-gatherer” - Wikipedia, citing research on mortality rates</p>

<p>[6] “Human mortality improvement in evolutionary context” - Study published in PMC (PubMed Central)</p>

<p>[7] Research by David A. Nibert on animal domestication and human society transformation</p>

<p>[8] Keynes’ 1930 essay “Economic Possibilities for our Grandchildren” referenced in multiple sources</p>

<p>[9] Interviews with James Suzman about his book in The Guardian and other publications</p>


          <hr>


            <center><p id="comment-zone">~ •• • •• ~</p><h3>Does something bubble up for you?<br>Pin your ideas or thoughts here 📌</h3><h4>Anyone can interact here. This is my little communication experiment.<br>I'd love to hear from you!</h4><br></center>


            <script src="https://cdn.fastcomments.com/js/embed-v2.min.js"></script>
            <div id="fastcomments-widget"></div>
            <script>
              FastCommentsUI(document.getElementById('fastcomments-widget'), {
                tenantId: "dI13cVRENXn",
                urlId: "MMSLifeBeforeAgriculturalRevolution" // Uses your unique marble ID for comments

              });
            </script>

            
            

            <center>

              <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank"><img src="https://mirrors.creativecommons.org/presskit/logos/cc.logo.svg" alt="Creative Commons License" style="border-radius: 0px; width: 100px; padding-bottom: 8px;"> </a><h4 style="font-size: 9px; font-weight: 700;">License for all original work:</h4>
              <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">
                <img src="https://mirrors.creativecommons.org/presskit/buttons/88x31/svg/by-nc-sa.svg" alt="Creative Commons License" style="border-radius: 0px;">
              </a></center><br>


            <center><a href="#" class="card-meta-author" style="display: inline-block; vertical-align: middle;text-decoration: none; font-size: 12px;">
                <img src="../../images/ID-photoshop-file.png" alt="ID" style="display: inline;">
                <span style="bottom: -1.5px; position: relative;">MMSLifeBeforeAgriculturalRevolution</span>
              </a></center>
              <br>


        </article>

      </div>


  </div>
  </section>









<footer class="footer">
  <svg class="footer-border" height="214" viewBox="0 0 2204 214" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M2203 213C2136.58 157.994 1942.77 -33.1996 1633.1 53.0486C1414.13 114.038 1200.92 188.208 967.765 118.127C820.12 73.7483 263.977 -143.754 0.999958 158.899"
      stroke-width="2" />
  </svg>





  <div class="container">
      <div class="row align-items-center">
      <div class="col-md-5 text-center text-md-left mb-4">

          <ul class="list-inline footer-list mb-0">



          <li class="list-inline-item"><a href="https://www.linkedin.com/in/leonsanten/" target="_blank" style="text-decoration: none;"><i class="ti-linkedin"></i></a></li>

          <li class="list-inline-item"><a href="https://www.instagram.com/mostly.mutual.studio/" target="_blank" style="text-decoration: none;"><i class="ti-instagram"></i></a></li>

          <li class="list-inline-item"><a href="mailto:lsanten@olin.edu" target="_blank" style="text-decoration: none;"><i class="ti-email"></i></a></li>



          </ul>
      </div>
      <div class="col-md-2 text-center mb-4">
          <a href="../../"><img class="img-fluid" style="display: inline;" width="100px" src="../../assets/marble-assets/images/backgrounds/shape-5.png" alt="A drawing of a valley in a hill wiht a bunch of little black dots collected in the middle"></a>
      </div>
      <div class="col-md-5 text-md-right text-center mb-4">

          <ul class="list-inline footer-list mb-0">
            <li class="list-inline-item">
              here is my pouch of 🔮 <a href="../MMSHomepage" target="_blank" style="display: inline;">favorite marbles</a>
              <br>
              here are my 🌍 <a href="../../" target="_blank" style="display: inline;">bio & homepage</a>
            </li>


          </ul>

      </div>
      <div class="col-12">
          <div class="border-bottom border-default"></div>
      </div>
      </div>
  </div>
  </footer>


  <!-- Advanced Image Zoom Viewer HTML -->
  <div id="image-zoom-overlay">
    <div id="image-zoom-container">
      <img id="image-zoom-img" src="" alt="Zoomed image">
      <button id="image-zoom-close">&times;</button>
      <div id="zoom-info">Zoom: 100%</div>
    </div>
  </div>

  <!-- JS Plugins -->
  <script src="../../assets/marble-assets/plugins/jQuery/jquery.min.js"></script>

  <script src="../../assets/marble-assets/plugins/bootstrap/bootstrap.min.js"></script>

  <script src="../../assets/marble-assets/plugins/slick/slick.min.js"></script>

  <script src="../../assets/marble-assets/plugins/instafeed/instafeed.min.js"></script>


  <!-- Main Script -->
  <script src="../../assets/marble-assets/js/script.js"></script>


  <!-- FOR EXPAND BUTTON -->
  <script>
  $(document).ready(function(){
     $(".read").click(function(){
        $(this).prev().toggle();
        $(this).siblings('.dots').toggle();
        if($(this).text()=='⏶ show less 📩'){
    $(this).text(' 💌 ');
        }
        else{
    $(this).text('⏶ show less 📩');
        }
     });
  });

  var coll = document.getElementsByClassName("collapsible");
  var i;

  for (i = 0; i < coll.length; i++) {
    coll[i].addEventListener("click", function() {
      this.classList.toggle("active");
      var content = this.nextElementSibling;
      if (content.style.display === "block") {
        content.style.display = "none";
      } else {
        content.style.display = "block";
      }
    });
  }
  </script>
  <!-- END EXPAND BUTTON -->

  <!-- FOR TAG FILTERS -->

  <script>
  filterSelection("all")
  function filterSelection(c) {
    var x, i;
    x = document.getElementsByClassName("filterDiv");
    if (c == "all") c = "";
    for (i = 0; i < x.length; i++) {
      w3RemoveClass(x[i], "show");
      if (x[i].className.indexOf(c) > -1) w3AddClass(x[i], "show");
    }
  }

  function w3AddClass(element, name) {
    var i, arr1, arr2;
    arr1 = element.className.split(" ");
    arr2 = name.split(" ");
    for (i = 0; i < arr2.length; i++) {
      if (arr1.indexOf(arr2[i]) == -1) {element.className += " " + arr2[i];}
    }
  }

  function w3RemoveClass(element, name) {
    var i, arr1, arr2;
    arr1 = element.className.split(" ");
    arr2 = name.split(" ");
    for (i = 0; i < arr2.length; i++) {
      while (arr1.indexOf(arr2[i]) > -1) {
        arr1.splice(arr1.indexOf(arr2[i]), 1);
      }
    }
    element.className = arr1.join(" ");
  }

  // Add active class to the current button (highlight it)
  var btnContainer = document.getElementById("myBtnContainer");
  if (btnContainer) {
    var btns = btnContainer.getElementsByClassName("btn");
    for (var i = 0; i < btns.length; i++) {
      btns[i].addEventListener("click", function(){
        var current = document.getElementsByClassName("active");
        current[0].className = current[0].className.replace(" active", "");
        this.className += " active";
      });
    }
  }
  </script>

  <!-- END TAG FILTERS -->

  <!-- Advanced Image Zoom Viewer Script -->
  <script>
  document.addEventListener('DOMContentLoaded', function() {
    // Elements
    const overlay = document.getElementById('image-zoom-overlay');
    const container = document.getElementById('image-zoom-container');
    const zoomedImg = document.getElementById('image-zoom-img');
    const closeBtn = document.getElementById('image-zoom-close');
    const zoomInfo = document.getElementById('zoom-info');

    // Variables for zoom and pan
    let currentScale = 1;
    let translateX = 0;
    let translateY = 0;
    let lastX = 0;
    let lastY = 0;
    let isDragging = false;
    let dragStartX = 0;
    let dragStartY = 0;
    let dragDistance = 0;
    const minDragDistance = 5; // Threshold to consider a drag vs. a click
    let justFinishedDrag = false;

    // Configuration
    const minScale = 0.5;
    const maxScale = 5;
    const zoomFactor = 0.1; // How much to zoom on each wheel event

    // Find all content images
    const images = document.querySelectorAll('article img');

    // Set up image click handlers
    images.forEach(img => {
      // Skip small images and icons
      if (img.width < 100 || img.height < 100 || img.classList.contains('emoji')) {
        return;
      }

      img.style.cursor = 'zoom-in';
      img.addEventListener('click', function(e) {
        e.preventDefault();

        // Reset state
        currentScale = 1;
        translateX = 0;
        translateY = 0;
        lastX = 0;
        lastY = 0;
        isDragging = false;
        justFinishedDrag = false;
        dragDistance = 0;

        // Show image
        zoomedImg.src = this.src;
        overlay.style.display = 'flex';
        zoomedImg.style.transform = 'scale(1) translate(0px, 0px)';
        document.body.style.overflow = 'hidden'; // Prevent page scrolling

        // Show zoom info
        zoomInfo.textContent = 'Zoom: 100%';
        zoomInfo.style.opacity = '1';

        // Hide zoom info after 2 seconds
        setTimeout(() => {
          zoomInfo.style.opacity = '0';
        }, 2000);
      });
    });

    // Close when clicking on overlay (only if not dragging)
    overlay.addEventListener('click', function(e) {
      if (e.target === overlay && !justFinishedDrag) {
        closeViewer();
      }
      justFinishedDrag = false;
    });

    // Close when clicking the image (only if no zoom and no drag)
    zoomedImg.addEventListener('click', function(e) {
      if (currentScale <= 1.05 && !justFinishedDrag) {
        closeViewer();
      }
      justFinishedDrag = false;
    });

    // Close button
    closeBtn.addEventListener('click', closeViewer);

    // Keyboard close
    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape' && overlay.style.display === 'flex') {
        closeViewer();
      }
    });

    // Mouse wheel zoom
        container.addEventListener('wheel', function(e) {
          if (overlay.style.display !== 'flex') return;

          e.preventDefault();

          // Calculate zoom center (relative to image)
          const rect = zoomedImg.getBoundingClientRect();
          const mouseX = e.clientX - rect.left;
          const mouseY = e.clientY - rect.top;

          // Calculate zoom direction and amount
          const delta = -Math.sign(e.deltaY) * zoomFactor;
          let newScale = currentScale + delta * currentScale;

          // Limit zoom range
          newScale = Math.min(Math.max(newScale, minScale), maxScale);

          // Update transform origin based on mouse position
          const originX = mouseX / rect.width;
          const originY = mouseY / rect.height;

          // Update zoom
          setZoom(newScale, originX, originY);

          // Show zoom level
          zoomInfo.textContent = `Zoom: ${Math.round(newScale * 100)}%`;
          zoomInfo.style.opacity = '1';

          // Hide zoom info after 2 seconds
          clearTimeout(window.zoomInfoTimeout);
          window.zoomInfoTimeout = setTimeout(() => {
            zoomInfo.style.opacity = '0';
          }, 2000);
        });

        // Mouse drag
        zoomedImg.addEventListener('mousedown', function(e) {
          if (currentScale <= 1) return; // Only enable dragging when zoomed in

          isDragging = true;
          lastX = e.clientX;
          lastY = e.clientY;
          dragStartX = e.clientX;
          dragStartY = e.clientY;
          dragDistance = 0;
          justFinishedDrag = false;

          zoomedImg.classList.add('grabbing');
          e.preventDefault();
        });

        document.addEventListener('mousemove', function(e) {
          if (!isDragging) return;

          const dx = e.clientX - lastX;
          const dy = e.clientY - lastY;

          // Calculate total drag distance for this operation
          const totalDragX = e.clientX - dragStartX;
          const totalDragY = e.clientY - dragStartY;
          dragDistance = Math.sqrt(totalDragX * totalDragX + totalDragY * totalDragY);

          // Update translation
          translateX += dx;
          translateY += dy;

          // Apply transform
          applyTransform();

          lastX = e.clientX;
          lastY = e.clientY;
        });

        document.addEventListener('mouseup', function() {
          if (!isDragging) return;

          // Check if this was a drag or just a click
          if (dragDistance > minDragDistance) {
            justFinishedDrag = true;
          }

          isDragging = false;
          zoomedImg.classList.remove('grabbing');
        });

        // Touch events for mobile
        let initialDistance = 0;
        let initialScale = 1;
        let initialTouchX = 0;
        let initialTouchY = 0;

        zoomedImg.addEventListener('touchstart', function(e) {
          if (e.touches.length === 2) {
            // Pinch-to-zoom
            const touch1 = e.touches[0];
            const touch2 = e.touches[1];

            initialDistance = Math.hypot(
              touch2.clientX - touch1.clientX,
              touch2.clientY - touch1.clientY
            );

            initialScale = currentScale;
            e.preventDefault();
          } else if (e.touches.length === 1 && currentScale > 1) {
            // Pan
            isDragging = true;
            lastX = e.touches[0].clientX;
            lastY = e.touches[0].clientY;
            dragStartX = e.touches[0].clientX;
            dragStartY = e.touches[0].clientY;
            dragDistance = 0;
            justFinishedDrag = false;
            e.preventDefault();
          }

          initialTouchX = e.touches[0].clientX;
          initialTouchY = e.touches[0].clientY;
        });

        zoomedImg.addEventListener('touchmove', function(e) {
          if (e.touches.length === 2) {
            // Pinch-to-zoom
            const touch1 = e.touches[0];
            const touch2 = e.touches[1];

            const currentDistance = Math.hypot(
              touch2.clientX - touch1.clientX,
              touch2.clientY - touch1.clientY
            );

            // Calculate new scale
            const pinchRatio = currentDistance / initialDistance;
            let newScale = initialScale * pinchRatio;

            // Limit zoom range
            newScale = Math.min(Math.max(newScale, minScale), maxScale);

            // Calculate midpoint for zoom origin
            const midX = (touch1.clientX + touch2.clientX) / 2;
            const midY = (touch1.clientY + touch2.clientY) / 2;

            const rect = zoomedImg.getBoundingClientRect();
            const originX = (midX - rect.left) / rect.width;
            const originY = (midY - rect.top) / rect.height;

            // Update zoom
            setZoom(newScale, originX, originY);

            // Show zoom level
            zoomInfo.textContent = `Zoom: ${Math.round(newScale * 100)}%`;
            zoomInfo.style.opacity = '1';

            // Hide zoom info after 2 seconds
            clearTimeout(window.zoomInfoTimeout);
            window.zoomInfoTimeout = setTimeout(() => {
              zoomInfo.style.opacity = '0';
            }, 2000);

            e.preventDefault();
          } else if (isDragging && e.touches.length === 1) {
            // Pan
            const touchX = e.touches[0].clientX;
            const touchY = e.touches[0].clientY;

            const dx = touchX - lastX;
            const dy = touchY - lastY;

            // Calculate total drag distance
            const totalDragX = touchX - dragStartX;
            const totalDragY = touchY - dragStartY;
            dragDistance = Math.sqrt(totalDragX * totalDragX + totalDragY * totalDragY);

            // Update translation
            translateX += dx;
            translateY += dy;

            // Apply transform
            applyTransform();

            lastX = touchX;
            lastY = touchY;

            e.preventDefault();
          }
        });

        zoomedImg.addEventListener('touchend', function(e) {
          if (isDragging) {
            // Check if this was a drag or just a tap
            if (dragDistance > minDragDistance) {
              justFinishedDrag = true;
            } else {
              // Check if it was a single tap on the image with no zoom
              if (currentScale <= 1.05 && !justFinishedDrag) {
                closeViewer();
              }
            }

            isDragging = false;
          } else if (e.touches.length === 0 && dragDistance < minDragDistance) {
            // It was a tap, not a drag
            const touchEndX = e.changedTouches[0].clientX;
            const touchEndY = e.changedTouches[0].clientY;

            // Calculate distance from start to end
            const tapDistance = Math.hypot(
              touchEndX - initialTouchX,
              touchEndY - initialTouchY
            );

            // If tap distance is small and we're not zoomed, close the viewer
            if (tapDistance < minDragDistance && currentScale <= 1.05) {
              closeViewer();
            }
          }
        });

        // Helper functions
        function setZoom(scale, originX, originY) {
          currentScale = scale;

          // Apply transform with correct origin
          zoomedImg.style.transformOrigin = `${originX * 100}% ${originY * 100}%`;
          applyTransform();
        }

        function applyTransform() {
          zoomedImg.style.transform = `translate(${translateX}px, ${translateY}px) scale(${currentScale})`;
        }

        function closeViewer() {
          overlay.style.display = 'none';
          document.body.style.overflow = ''; // Restore page scrolling

          // Reset state
          currentScale = 1;
          translateX = 0;
          translateY = 0;
          zoomedImg.style.transform = 'scale(1) translate(0px, 0px)';
          justFinishedDrag = false;
        }

        // Double-click to reset
        zoomedImg.addEventListener('dblclick', function(e) {
          e.preventDefault();

          if (currentScale > 1) {
            // Reset to full view
            currentScale = 1;
            translateX = 0;
            translateY = 0;
            applyTransform();

            zoomInfo.textContent = 'Zoom: 100%';
            zoomInfo.style.opacity = '1';

            setTimeout(() => {
              zoomInfo.style.opacity = '0';
            }, 2000);
          } else {
            // Zoom in
            const rect = zoomedImg.getBoundingClientRect();
            const mouseX = e.clientX - rect.left;
            const mouseY = e.clientY - rect.top;

            const originX = mouseX / rect.width;
            const originY = mouseY / rect.height;

            setZoom(2, originX, originY);

            zoomInfo.textContent = 'Zoom: 200%';
            zoomInfo.style.opacity = '1';

            setTimeout(() => {
              zoomInfo.style.opacity = '0';
            }, 2000);
          }
        });

        // Tap twice (double tap) for mobile
        let lastTapTime = 0;
        zoomedImg.addEventListener('touchend', function(e) {
          const currentTime = new Date().getTime();
          const tapLength = currentTime - lastTapTime;

          if (tapLength < 300 && tapLength > 0) {
            // Double tap detected
            e.preventDefault();

            if (currentScale > 1) {
              // Reset to full view
              currentScale = 1;
              translateX = 0;
              translateY = 0;
              applyTransform();

              zoomInfo.textContent = 'Zoom: 100%';
              zoomInfo.style.opacity = '1';
            } else {
              // Zoom in to where user tapped
              const touch = e.changedTouches[0];
              const rect = zoomedImg.getBoundingClientRect();
              const touchX = touch.clientX - rect.left;
              const touchY = touch.clientY - rect.top;

              const originX = touchX / rect.width;
              const originY = touchY / rect.height;

              setZoom(2, originX, originY);

              zoomInfo.textContent = 'Zoom: 200%';
              zoomInfo.style.opacity = '1';
            }

            setTimeout(() => {
              zoomInfo.style.opacity = '0';
            }, 2000);
          }

          lastTapTime = currentTime;
        });
      });
      </script>
    </html>
